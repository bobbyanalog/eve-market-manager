<html><body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src='types.custom.js'></script>
<a href="http://13.217.100.0/emh"><img src="https://web.ccpgamescdn.com/eveonlineassets/developers/eve-sso-login-black-small.png" /></a>
<div id="test"></div>
<hr>
<div id="content"></div>
<script>
//console.log(types);
if (window.location.toString().includes('?')) {
  var urlParamStr = window.location.toString().split('?')[1];
  var urlParams = urlParamStr.split('&');
  for (var i = 0; i < urlParams.length; i++) {
    var pair = urlParams[i].split('=');
    if (pair[0] == 'access_token') {
      var idStr = JSON.parse(atob(pair[1].split('.')[1]))['sub'];
      var charID = idStr.split(':')[2];
      console.log("https://esi.evetech.net/characters/"+charID);
      $.ajax({url: "https://esi.evetech.net/characters/"+charID, success: function(result){
        var charName = result['name'];
        var charCorpID = result['corporation_id'];
        $("#test").html(charName + ' ' + charCorpID);
        console.log(result);
      }});
    }
  }
}

$.ajax({url: "https://esi.evetech.net/universe/regions", success: function(result){
  var regIDs = result;
  //console.log(regIDs);
  // 10000069 black rise
}});

$.ajax({url: "https://esi.evetech.net/markets/10000069/orders?order_type=sell", success: function(data, status, response){
  console.log(data);
  console.log(status);
  console.log(response);
  console.log(response.getAllResponseHeaders());
  var content = 'Sell Orders<br>';
  //for (i = 0; i <= 10; i++) {
  for (i = 0; i <= data.length; i++) {
    //console.log(data[i]);
    var ent = data[i];
    console.log(ent);
    var tid = ent['type_id'];
    content += types[tid]['name'] + ' | quantity:' + ent['volume_remain'] + ' | price:' + ent['price'] + ' | system_id:' + ent['system_id'] + ' | location_id:' + ent['location_id'] + ' | duration:' + ent['duration'] + '<br>';
  }
  $("#content").html(content)
}});
  
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
  console.log(xhr);
};
//xhr.open('GET', 'https://esi.evetech.net/latest/markets/groups/?datasource=tranquility');
//xhr.send()

</script>
</body></html>
